extends layout

block content
  h1 Your results
  button(id="chord") Click Me
  input(id="genes" value="#{songString}")
  each g, i in genotypes
    p <b>#{names[g.id]} #{JSON.stringify(g)}</b>
  
  script(type="text/javascript").
    Array.prototype.random = function(){
      return this[Math.floor((Math.random()*this.length))];
    }
    var synth = new Tone.Synth().toMaster()
    var noteLength = ["16n","8n","4n","2n"]
    var loop = new Tone.Loop(function(time){
      var data = document.getElementById('genes').value;
      var split = data.split(',');
      console.log(split[0])
      synth.triggerAttackRelease(split[0], noteLength.random(), time);
      //synth.triggerAttackRelease(["C4", "E4", "G4", "B4"], "8n")
      split = split.splice(1,split.length);
      console.log(split)
      document.getElementById('genes').value = split;
    }, "4n")
    loop.start(0).stop('17m')

    document.querySelectorAll('button').forEach(function(button){
      button.addEventListener('mousedown', function(e){
        Tone.Transport.start('+0.1')
      });
    });
